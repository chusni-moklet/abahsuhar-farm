<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Penjualan</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="auth.js"></script>
</head>
<body class="bg-gray-100 p-3 md:p-6 min-h-screen">

<div id="nav"></div>

<div class="max-w-md mx-auto">
<form id="form" class="bg-white p-4 md:p-6 rounded-xl shadow">
<h2 class="text-lg md:text-xl font-bold mb-4">ðŸ›’ Penjualan</h2>

<label class="block text-sm font-medium text-gray-700 mb-1">Tanggal</label>
<input type="date" id="tgl" class="input" required>

<label class="block text-sm font-medium text-gray-700 mb-1">Jenis Ayam</label>
<select id="induk" class="input" required>
  <option value="">Pilih Jenis</option>
  <option>Mardi ORI</option>
  <option>Bangkodi</option>
  <option>Bangkok x Aseel</option>
</select>

<label class="block text-sm font-medium text-gray-700 mb-1">Jumlah (ekor)</label>
<input type="number" id="jumlah" placeholder="Jumlah" class="input" required min="1">

<label class="block text-sm font-medium text-gray-700 mb-1">Harga Satuan (Rp)</label>
<input type="number" id="harga" placeholder="Harga per ekor" class="input" required min="0">

<div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3">
  <div class="flex justify-between items-center">
    <span class="text-sm font-medium text-gray-700">Total Harga:</span>
    <span class="text-xl font-bold text-blue-600" id="totalHarga">Rp 0</span>
  </div>
</div>

<button class="btn" id="btnSimpan">Simpan</button>
</form>
</div>

<script>
const URL = "https://script.google.com/macros/s/AKfycbwTJsrh2DhW2IzBRwfDvbf6XTKwNPaqrxSRK1z6ZaO9NgY8nWGI1cGvRymwgNa0p2Hz_Q/exec";

fetch("navbar.html").then(r=>r.text()).then(t=>nav.innerHTML=t);

// Hitung total otomatis
function hitungTotal(){
  const jml = parseFloat(jumlah.value) || 0;
  const hrg = parseFloat(harga.value) || 0;
  const total = jml * hrg;
  totalHarga.textContent = 'Rp ' + total.toLocaleString('id-ID');
}

jumlah.addEventListener('input', hitungTotal);
harga.addEventListener('input', hitungTotal);

form.onsubmit=e=>{
e.preventDefault();
btnSimpan.disabled = true;
btnSimpan.innerHTML = 'â³ Menyimpan...';

fetch(URL,{
method:"POST",
body:JSON.stringify({
sheet:"PENJUALAN",
values:[tgl.value,jumlah.value,induk.value,"DOC",harga.value,jumlah.value*harga.value]
})
}).then(()=>{
alert("Data tersimpan");
form.reset();
totalHarga.textContent = 'Rp 0';
}).catch(err=>{
alert("Gagal menyimpan: " + err.message);
}).finally(()=>{
btnSimpan.disabled = false;
btnSimpan.innerHTML = 'Simpan';
});
}
</script>

<style>
.input{width:100%;border:1px solid #ccc;padding:10px 12px;border-radius:8px;margin-bottom:10px;font-size:16px}
.btn{background:#16a34a;color:white;padding:12px;width:100%;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer}
.btn:hover{background:#15803d}
.btn:disabled{background:#9ca3af;cursor:not-allowed}
@media (max-width: 640px) {
  .input{padding:12px;font-size:16px}
  .btn{padding:14px;font-size:16px}
}
</style>
</body>
</html>
